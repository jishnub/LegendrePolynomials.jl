<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Derivatives · LegendrePolynomials</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://jishnub.github.io/LegendrePolynomials.jl/derivatives/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">LegendrePolynomials</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>Derivatives</a><ul class="internal"><li><a class="tocitem" href="#Analytical-recursive-approach"><span>Analytical recursive approach</span></a></li><li><a class="tocitem" href="#Automatic-diferentiation"><span>Automatic diferentiation</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Derivatives</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Derivatives</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jishnub/LegendrePolynomials.jl/blob/master/docs/src/derivatives.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Derivatives-of-Legendre-Polynomials"><a class="docs-heading-anchor" href="#Derivatives-of-Legendre-Polynomials">Derivatives of Legendre Polynomials</a><a id="Derivatives-of-Legendre-Polynomials-1"></a><a class="docs-heading-anchor-permalink" href="#Derivatives-of-Legendre-Polynomials" title="Permalink"></a></h1><h2 id="Analytical-recursive-approach"><a class="docs-heading-anchor" href="#Analytical-recursive-approach">Analytical recursive approach</a><a id="Analytical-recursive-approach-1"></a><a class="docs-heading-anchor-permalink" href="#Analytical-recursive-approach" title="Permalink"></a></h2><p>The Bonnet&#39;s recursion formula</p><p class="math-container">\[P_\ell(x) = \left((2\ell-1) x P_{\ell-1}(x) - (\ell-1)P_{\ell - 2}(x)\right)/\ell\]</p><p>may be differentiated an arbitrary number of times analytically to obtain recursion relations for higher derivatives:</p><p class="math-container">\[\frac{d^n P_\ell(x)}{dx^n} = \frac{(2\ell-1)}{\ell} \left(x \frac{d^n P_{\ell-1}(x)}{dx^n} +
n \frac{d^{(n-1)} P_{\ell-1}(x)}{dx^{(n-1)}} \right) - \frac{(\ell-1)}{\ell} \frac{d^n P_{\ell-2}(x)}{dx^n}\]</p><p>This provides a simultaneous recursion relation in <span>$\ell$</span> as well as <span>$n$</span>, solving which we may obtain derivatives up to any order. This is the approach used in this package to compute the derivatives of Legendre polynomials.</p><h2 id="Automatic-diferentiation"><a class="docs-heading-anchor" href="#Automatic-diferentiation">Automatic diferentiation</a><a id="Automatic-diferentiation-1"></a><a class="docs-heading-anchor-permalink" href="#Automatic-diferentiation" title="Permalink"></a></h2><p>The Julia automatic differentiation framework may be used to compute the derivatives of Legendre polynomials alongside their values. Since the defintions of the polynomials are completely general, they may be called with dual or hyperdual numbers as arguments to evaluate derivarives in one go. We demonstrate one example of this using the package <a href="https://github.com/JuliaDiff/HyperDualNumbers.jl"><code>HyperDualNumbers.jl</code></a> v4:</p><pre><code class="language-julia-repl hljs">julia&gt; x = 0.5;

julia&gt; Pl(x, 3)
-0.4375

julia&gt; using HyperDualNumbers

julia&gt; xh = Hyper(x, one(x), one(x), zero(x));

julia&gt; p = Pl(xh, 3)
-0.4375 + 0.375ε₁ + 0.375ε₂ + 7.5ε₁ε₂</code></pre><p>The Legendre polynomial <span>$P_\ell(x)$</span> may be obtained using</p><pre><code class="language-julia-repl hljs">julia&gt; realpart(p)
-0.4375</code></pre><p>The first derivative <span>$dP_\ell(x)/dx$</span> may be obtained as</p><pre><code class="language-julia-repl hljs">julia&gt; ε₁part(p)
0.375</code></pre><p>The second derivative <span>$d^2P_\ell(x)/dx^2$</span> may be obtained using</p><pre><code class="language-julia-repl hljs">julia&gt; ε₁ε₂part(p)
7.5</code></pre><p>Something similar may also be evaluated for all <code>l</code> iteratively. For example, the function <code>collectPl</code> evaluates Legendre polynomials for the <code>HyperDualNumber</code> argument for a range of <code>l</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; collectPl(xh, lmax=4)
5-element OffsetArray(::Vector{Hyper{Float64}}, 0:4) with eltype Hyper{Float64} with indices 0:4:
                1.0 + 0.0ε₁ + 0.0ε₂ + 0.0ε₁ε₂
                0.5 + 1.0ε₁ + 1.0ε₂ + 0.0ε₁ε₂
             -0.125 + 1.5ε₁ + 1.5ε₂ + 3.0ε₁ε₂
        -0.4375 + 0.375ε₁ + 0.375ε₂ + 7.5ε₁ε₂
 -0.2890625 - 1.5625ε₁ - 1.5625ε₂ + 5.625ε₁ε₂</code></pre><p>We may extract the first derivatives by broadcasting the function <code>ε₁part</code> on the array as:</p><pre><code class="language-julia-repl hljs">julia&gt; ε₁part.(collectPl(xh, lmax=4))
5-element OffsetArray(::Vector{Float64}, 0:4) with eltype Float64 with indices 0:4:
  0.0
  1.0
  1.5
  0.375
 -1.5625</code></pre><p>Similarly the function <code>ε₁ε₂part</code> may be used to obtain the second derivatives.</p><p>Several convenience functions to compute the derivatives of Legendre polynomials were available in <code>LegendrePolynomials</code> v0.2, but have been removed in v0.3. The users are encouraged to implement convenience functions to extract the derivatives as necessary. As an exmaple, we may compute the polynomials and their first and second derivatives together as</p><pre><code class="language-julia-repl hljs">julia&gt; using HyperDualNumbers

julia&gt; function Pl_dPl_d2Pl(x; lmax)
           xh = Hyper(x, one(x), one(x), zero(x))
           p = collectPl(xh, lmax = lmax)
           realpart.(p), ε₁part.(p), ε₁ε₂part.(p)
       end
Pl_dPl_d2Pl (generic function with 1 method)

julia&gt; Pl_dPl_d2Pl(0.5, lmax = 3)
([1.0, 0.5, -0.125, -0.4375], [0.0, 1.0, 1.5, 0.375], [0.0, 0.0, 3.0, 7.5])</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.13 on <span class="colophon-date" title="Tuesday 1 March 2022 04:56">Tuesday 1 March 2022</span>. Using Julia version 1.6.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
